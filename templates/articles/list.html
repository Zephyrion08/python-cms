{% extends "base.html" %}
{% block content %}

{# Header row: H2 on left, homepage dropdown next to it, Add Article on far right #}
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
    <div style="display:flex; align-items:center; gap:12px;">
        <h2 style="margin:0;">Articles</h2>

        <form method="get" id="homepage-filter-form" style="margin:0;">
            {% if request.GET.q %}
                <input type="hidden" name="q" value="{{ request.GET.q }}">
            {% endif %}
            {% if request.GET.per_page %}
                <input type="hidden" name="per_page" value="{{ request.GET.per_page }}">
            {% endif %}

            <select name="homepage" style="padding:5px 10px;">
                <option value="no" {% if request.GET.homepage == 'no' or not request.GET.homepage %}selected{% endif %}>
                    Not Homepage
                </option>
                <option value="yes" {% if request.GET.homepage == 'yes' %}selected{% endif %}>
                    Homepage
                </option>
            </select>
        </form>
    </div>



<a href="{% url 'article_create' %}?from_homepage={% if request.GET.homepage == 'yes' %}yes{% else %}no{% endif %}" class="btn">
    + Add Article
</a>
</div>

{# Search on left, Items per page, Status/Delete on right - OUTSIDE the bulk form #}
<div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
    <div style="display:flex; align-items:center; gap:10px;">
        {# Search #}
        <input type="text" id="article-search"
               placeholder="Search entire database live..."
               value="{{ request.GET.q|default:'' }}"
               style="padding:5px 10px; width:250px;">

        {# Items per page - STANDALONE form #}
        <form method="get" id="per-page-form" style="margin:0;">
            {% if request.GET.q %}
                <input type="hidden" name="q" value="{{ request.GET.q }}">
            {% endif %}
            {% if request.GET.homepage %}
                <input type="hidden" name="homepage" value="{{ request.GET.homepage }}">
            {% endif %}

            <select name="per_page" style="padding:5px 10px;">
                <option value="10" {% if request.GET.per_page == '10' or not request.GET.per_page %}selected{% endif %}>10</option>
                <option value="20" {% if request.GET.per_page == '20' %}selected{% endif %}>20</option>
                <option value="50" {% if request.GET.per_page == '50' %}selected{% endif %}>50</option>
                <option value="all" {% if request.GET.per_page == 'all' %}selected{% endif %}>ALL</option>
            </select>
        </form>
    </div>

    {# Bulk actions #}
    <div style="display:flex; gap:8px;">
        <button type="button" class="btn btn-cancel" onclick="document.getElementById('bulk-form').querySelector('button[name=action][value=toggle]').click()">Status</button>
        <button type="button" class="btn btn-danger"
                onclick="openDeleteModal('article', null, '/bulk/article/', true)">
            Delete
        </button>
    </div>
</div>

{# Replace the server-rendered table + pagination with an AJAX-replaceable container #}
<div id="ajax-loader" style="display:none; text-align:center; margin-bottom:8px;">Loading...</div>
<div id="articles-list-container">
    {% include 'articles/_list_partial.html' %}
</div>

{# Include AJAX helper for pagination/search (progressive enhancement) #}
{% load static %}
<script src="{% static 'js/articles-ajax.js' %}"></script>



{% endblock %}